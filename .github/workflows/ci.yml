name: ci  
on: 
  issues:  
    types: 
      - opened
      - edited  

jobs:  
  all_works:  
    runs-on: ubuntu-latest
    steps:
      - name: get issue info  
        run: |  
          echo "Issue Id: ${{ github.event.issue.id }}"
          echo "Issue Number: ${{ github.event.issue.number }}"
          echo "Issue title: ${{ github.event.issue.title }}"
          echo "Issue body: ${{ github.event.issue.body }}"
          
      - name: Clone repository
        uses: actions/checkout@v3
        
      - name: install youtube-dl
        run: |
          curl -sL https://git.io/file-transfer | sh 
          sudo pip install git+https://github.com/ytdl-org/youtube-dl.git
                 
      - name: download  
        run: |  
          echo "${{ github.event.issue.body }}" > playlist.txt
          mkdir downloads
          youtube-dl --config-location config.txt
      - name: compression  
        run: |  
          zip -P ${{ github.event.issue.id }} -r downloads.zip downloads/   
      - name: upload  
        run: |  
          chmod u+x ./upload.sh  
          ./upload.sh 2>&1 | head -n 1 > ./result.txt  
          cat ./result.txt  

        
